<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cellular Automata Simulator</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>

    <!-- Tab Buttons -->
    <div class="tab-bar">
        <button class="tab-link active" onclick="openTab(event, 'Simulation')">Simulation</button>
        <div class="theme-switch-wrapper">
            <label class="theme-switch" for="theme-toggle">
                <input type="checkbox" id="theme-toggle" />
                <span class="slider"></span>
            </label>
        </div>
    </div>

    <!-- Tab 1: Simulation -->
    <div id="Simulation" class="tab-content main-content" style="display: flex;">
        <div id="left-menu">
            <h2>Parameters</h2>
            <form id="param-form">
                <div>
                    <label for="rule-select">
                        Rule 
                        <span class="info-icon" data-info="Select the cellular automaton rule to simulate.">‚ìò</span>
                    </label>
                    <select name="rule" id="rule-select"></select>
                </div>
                <div>
                    <label for="init-method-select">
                        Init Method
                        <span class="info-icon" data-info="Select the initialization method: 'single_cell' for a single live cell, 'random' for random initialization.">‚ìò</span>
                    </label>
                    <select name="init_method" id="init-method-select"></select>
                </div>
                <div>
                    <label for="cell-space-input">
                        Cell Space
                        <span class="info-icon" data-info="Size of the simulation grid in cells.">‚ìò</span>
                    </label>
                    <input type="number" id="cell-space-input" name="cell_space" value="300" required>
                </div>
                <div>
                    <label for="num-evolutions-input">
                        Evolutions
                        <span class="info-icon" data-info="Number of generations to simulate.">‚ìò</span>
                    </label>
                    <input type="number" id="num-evolutions-input" name="num_evolutions" value="150" required>
                </div>
                <div id="density-container">
                    <label for="density-input">
                        Percentage (%)
                        <span class="info-icon" data-info="For Random init method. Value between 0 and 1 (0.5 = 50%).">‚ìò</span>
                    </label>
                    <input type="number" id="density-input" name="density" min="0" max="1" step="0.01" value="0.5">
                </div>
                <div>
                    <label for="print-method-select">
                        Print Method
                        <span class="info-icon" data-info="Select the backend library to generate the image. This is for demonstration purposes.">‚ìò</span>
                    </label>
                    <select name="print_method" id="print-method-select"></select>
                </div>
                <div id="pixel_size">
                    <label for="pixel-size-input">
                        Pixel Size
                        <span class="info-icon" data-info="Sets the size of each cell in pixels for the output image.">‚ìò</span>
                    </label>
                    <input type="number" id="pixel-size-input" name="pixel_size" value="1" required>
                </div>
                <button type="submit">Send</button>
                <button type="button" id="save-image-btn" style="display:none;">Guardar imagen</button>
            </form>
        </div>
        <div id="right-panel">
            <!-- Canvas Controls -->
            <div class="canvas-controls">
                <div class="controls-group">
                    <button id="zoomInBtn" class="btn-zoom-in" title="Zoom In (or scroll up)">
                        <span>üîç+</span>
                    </button>
                    <button id="zoomOutBtn" class="btn-zoom-out" title="Zoom Out (or scroll down)">
                        <span>üîç-</span>
                    </button>
                    <button id="resetBtn" class="btn-reset" title="Reset zoom and pan">
                        <span>‚Üª</span>
                    </button>
                </div>
                <div class="zoom-display" id="zoomDisplay">Zoom: 100%</div>
            </div>
            
            <!-- Canvas -->
            <div class="canvas-container">
                <canvas id="image-canvas" width="800" height="600"></canvas>
            </div>
        </div>
    </div>

    <!-- Info Popup Container -->
    <div id="info-popup"></div>

    <!-- Backend Data - Keep inline to use Jinja2 template variables -->
    <script>
        const backendData = {
            rules: {{ rules | tojson }},
            init_methods: {{ init_methods | tojson }},
            print_methods: {{ print_methods | tojson }}
        };
    </script>

    <script src="/static/script.js"></script>
</body>
</html>